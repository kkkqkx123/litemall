# Graphviz 中文字体快速参考

## 🚀 快速开始

```python
# 1. 导入库并设置编码
# -*- coding: utf-8 -*-
from graphviz import Digraph
import os

# 2. 设置环境变量
os.environ['GRAPHVIZ_DOT'] = 'dot'
os.environ['LC_ALL'] = 'zh_CN.UTF-8'
os.environ['LANG'] = 'zh_CN.UTF-8'

# 3. 自动字体检测
def find_available_font():
    fonts = ['SimSun', 'Microsoft YaHei', 'SimHei', 'NSimSun', 'Arial Unicode MS']
    for font in fonts:
        try:
            test = Digraph('test', format='png', encoding='utf-8')
            test.node('test_node', '测试', fontname=font)
            test.render('font_test', cleanup=True)
            return font
        except:
            continue
    return 'Arial'

CHINESE_FONT = find_available_font()

# 4. 创建图表并设置字体
graph = Digraph('图表', format='png', encoding='utf-8')
graph.graph_attr['fontname'] = CHINESE_FONT
graph.node_attr['fontname'] = CHINESE_FONT
graph.edge_attr['fontname'] = CHINESE_FONT

# 5. 添加中文内容并生成
graph.node('节点', '中文内容', fontname=CHINESE_FONT)
graph.render('output', view=True)
```

## 🔤 字体优先级（推荐顺序）

1. **SimSun** - 兼容性最好 ⭐⭐⭐⭐⭐
2. **Microsoft YaHei** - 现代简洁 ⭐⭐⭐⭐
3. **SimHei** - 视觉效果好 ⭐⭐⭐⭐
4. **NSimSun** - 传统风格 ⭐⭐⭐
5. **Arial Unicode MS** - 跨平台 ⭐⭐⭐

## 🛠️ 常见问题速查

| 问题 | 解决方案 |
|------|----------|
| 中文显示方框 | 使用字体检测函数，尝试不同字体 |
| 字体显示异常 | 检查文件编码，确认 UTF-8 |
| 图表生成失败 | 检查 Graphviz 安装，简化测试 |
| 字体名称错误 | 使用系统字体管理器查看正确名称 |

## 📋 样式模板

```python
# 实体样式
ENTITY = {
    'shape': 'box', 'fontname': CHINESE_FONT,
    'style': 'filled', 'fillcolor': 'lightblue'
}

# 属性样式  
ATTRIBUTE = {
    'shape': 'ellipse', 'fontname': CHINESE_FONT,
    'style': 'filled', 'fillcolor': 'lightyellow'
}

# 关系样式
RELATIONSHIP = {
    'shape': 'diamond', 'fontname': CHINESE_FONT,
    'style': 'filled', 'fillcolor': 'lightgreen'
}
```

## 🎯 一键测试脚本

```bash
# Windows
python -c "
from graphviz import Digraph
fonts = ['SimSun','Microsoft YaHei','SimHei','NSimSun','Arial Unicode MS']
for f in fonts:
    try:
        g = Digraph('test', format='png', encoding='utf-8')
        g.node('test', '中文测试', fontname=f)
        g.render(f'test_{f}', cleanup=True)
        print(f'{f}: ✅')
    except:
        print(f'{f}: ❌')
"
```