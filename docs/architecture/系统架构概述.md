# 系统架构概述

## 项目简介

litemall是一个基于Spring Boot的轻量级电商系统，采用前后端分离架构，支持微信小程序、Vue移动端和管理后台三个前端应用。系统设计遵循微服务思想，通过模块化拆分实现高内聚低耦合。

## 整体架构

系统采用分层架构设计，从上到下分为：

```
┌─────────────────────────────────────────┐
│                 前端层                    │
├─────────────────────────────────────────┤
│         API网关/负载均衡                │
├─────────────────────────────────────────┤
│         业务服务层（后端）              │
├─────────────────────────────────────────┤
│         数据持久化层                    │
├─────────────────────────────────────────┤
│         基础设施层                      │
└─────────────────────────────────────────┘
```

## 核心模块划分

### 1. 后端模块

#### 1.1 litemall-core（核心模块）
- **定位**：系统核心服务层
- **职责**：
  - 提供系统配置管理（application.yml）
  - 集成第三方服务（微信、阿里云、腾讯云等）
  - 提供通用工具类（文件上传、短信发送、支付等）
  - 异常处理和统一响应封装
- **技术栈**：Spring Boot、Jackson、HttpClient
- **关键依赖**：
  - 微信支付SDK（weixin-java-pay、weixin-java-miniapp）
  - 对象存储（阿里云OSS、腾讯云COS、七牛云）
  - 短信服务（腾讯云短信、阿里云短信）

#### 1.2 litemall-db（数据访问层）
- **定位**：数据库访问和ORM层
- **职责**：
  - 数据库实体定义（Entity）
  - MyBatis Mapper接口定义
  - MyBatis Generator代码生成配置
  - 分页插件集成
- **技术栈**：MyBatis、MyBatis Generator、PageHelper、Druid连接池
- **数据库支持**：MySQL 8.x
- **代码生成**：基于MyBatis Generator的自动化代码生成

#### 1.3 litemall-wx-api（微信小程序API）
- **定位**：微信小程序后端服务
- **职责**：
  - 提供小程序所有业务接口
  - 用户认证和授权（微信登录）
  - 商品浏览和购买流程
  - 订单管理和支付处理
  - 个人中心相关功能
- **技术栈**：Spring Boot、Spring MVC、Swagger文档
- **接口特点**：
  - RESTful API设计
  - JWT Token认证
  - 微信登录集成
  - 微信支付集成

#### 1.4 litemall-admin-api（管理后台API）
- **定位**：管理后台后端服务
- **职责**：
  - 提供管理后台所有业务接口
  - 管理员认证和权限控制
  - 商品、订单、用户、系统管理
  - 数据统计和报表
- **技术栈**：Spring Boot、Shiro权限框架、Swagger文档
- **安全特性**：
  - Shiro权限控制
  - 管理员登录验证
  - 图形验证码（Kaptcha）
  - 会话管理

#### 1.5 litemall-all（聚合服务）
- **定位**：单体应用聚合部署
- **职责**：
  - 整合所有后端模块为单一应用
  - 支持传统单体部署模式
  - 简化部署和运维
- **特点**：
  - 包含所有业务模块
  - 统一端口和上下文
  - 适合中小型部署场景

#### 1.6 litemall-all-war（WAR包部署）
- **定位**：传统WAR包部署支持
- **职责**：
  - 提供WAR包格式的部署文件
  - 支持传统Java EE容器（Tomcat、Jetty等）
  - 兼容传统运维环境

### 2. 前端模块

#### 2.1 litemall-admin（管理后台前端）
- **定位**：PC端管理后台
- **技术栈**：Vue 2.6 + Element UI
- **功能特性**：
  - 商品管理（商品、分类、品牌、规格）
  - 订单管理（订单、发货、售后）
  - 用户管理（会员、管理员）
  - 运营管理（优惠券、团购、专题）
  - 系统管理（配置、日志、权限）
- **构建工具**：Vue CLI 4.x
- **UI框架**：Element UI 2.15.6
- **特色功能**：
  - 富文本编辑器（TinyMCE）
  - 图表展示（ECharts）
  - 文件上传
  - 权限路由控制

#### 2.2 litemall-vue（移动端H5）
- **定位**：移动端H5商城
- **技术栈**：Vue 2.5 + Vant UI
- **功能特性**：
  - 商品展示和搜索
  - 购物车功能
  - 订单流程
  - 个人中心
  - 微信支付（H5）
- **UI框架**：Vant 2.x（有赞移动端组件库）
- **适配特性**：
  - 响应式设计
  - 移动端手势操作
  - 微信浏览器优化

#### 2.3 litemall-wx（微信小程序）
- **定位**：原生微信小程序
- **技术栈**：原生小程序框架
- **功能特性**：
  - 完整的电商小程序功能
  - 微信登录和支付
  - 小程序特有功能（分享、模板消息等）
  - 与后端API无缝对接
- **页面结构**：
  - 首页、分类、购物车、个人中心
  - 商品详情、订单流程、支付结果
  - 个人中心（订单、地址、优惠券等）

#### 2.4 renard-wx（备用小程序）
- **定位**：备用小程序项目
- **说明**：功能与litemall-wx类似，可能是不同风格或版本

## 数据架构

### 数据库设计
- **主数据库**：MySQL 8.x
- **连接池**：Druid（阿里巴巴开源）
- **ORM框架**：MyBatis + MyBatis Generator
- **分页插件**：PageHelper

### 核心数据表
- 用户相关：litemall_user、litemall_address
- 商品相关：litemall_goods、litemall_category、litemall_brand
- 订单相关：litemall_order、litemall_order_goods
- 系统相关：litemall_admin、litemall_system

## 部署架构

### 开发环境
```
前端开发 → API调用 → 后端服务 → MySQL数据库
```

### 生产环境
```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Nginx     │────│   后端服务   │────│   MySQL     │
│  (静态资源)  │    │ (SpringBoot)│    │  (主从复制)  │
└─────────────┘    └─────────────┘    └─────────────┘
```

### 部署方式
1. **单体部署**：使用litemall-all模块
2. **分布式部署**：各模块独立部署
3. **容器化部署**：支持Docker容器化
4. **传统部署**：支持WAR包部署

## 技术栈总结

### 后端技术栈
- **框架**：Spring Boot 2.1.5、MyBatis
- **数据库**：MySQL 8.x、Druid连接池
- **安全**：Shiro权限框架、JWT认证
- **文档**：Swagger 2.x、SpringFox
- **工具**：MyBatis Generator、Maven

### 前端技术栈
- **管理后台**：Vue 2.6 + Element UI
- **移动端**：Vue 2.5 + Vant
- **小程序**：原生微信小程序
- **构建工具**：Vue CLI 3.x/4.x

### 第三方服务
- **支付**：微信支付、支付宝（预留）
- **存储**：阿里云OSS、腾讯云COS、七牛云
- **短信**：腾讯云短信、阿里云短信
- **推送**：微信小程序模板消息

## 扩展能力

### 水平扩展
- 无状态服务设计，支持水平扩展
- 数据库主从复制，读写分离
- Redis缓存支持（预留）

### 垂直扩展
- 模块化设计，按需部署
- 功能插件化，易于扩展
- 配置外部化，环境适配

## 开发工作流

### 1. 需求分析
- 功能需求评审
- 技术方案设计
- 数据库设计

### 2. 开发阶段
- 后端：Entity → Mapper → Service → Controller
- 前端：页面设计 → API对接 → 功能测试
- 小程序：页面开发 → API对接 → 真机测试

### 3. 测试阶段
- 单元测试（JUnit）
- 接口测试（Swagger + Postman）
- 集成测试
- 性能测试

### 4. 部署阶段
- 环境配置（dev/test/prod）
- 数据库迁移
- 服务部署
- 监控配置

## 运维监控

### 健康检查
- Spring Boot Actuator
- 数据库连接监控
- 外部服务状态检查

### 日志管理
- 应用日志：Logback配置
- 访问日志：Nginx日志
- 错误日志：统一异常处理

### 性能监控
- 数据库性能监控
- API响应时间监控
- 系统资源监控

这个架构设计充分体现了现代电商系统的特点：模块化、可扩展、易维护，同时兼顾了传统部署和云原生部署的需求。