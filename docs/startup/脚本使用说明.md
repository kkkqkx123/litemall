# 启动脚本使用说明

## 脚本列表

### 1. start-web.ps1 - 管理后台启动脚本
**功能**：同时启动后端服务（Spring Boot）和前端服务（Vue管理后台）

**使用方法：**
```powershell
.\scripts\start-web.ps1 [参数]
```

**参数说明：**
- `-Port`: 指定后端端口（默认8080）
- `-Profile`: 指定环境配置（默认dev）
- `-SkipBuild`: 跳过构建过程
- `-SkipFrontend`: 跳过前端启动（仅启动后端）
- `-SkipBackend`: 跳过后端启动（仅启动前端）

**启动说明**：
- 后端服务：http://localhost:8080
- 前端服务：http://localhost:9527
- 两个服务会同时启动，无需手动分别启动

**示例：**
```powershell
# 默认启动
.\scripts\start-web.ps1

# 指定端口
.\scripts\start-web.ps1 -Port 8081

# 跳过构建
.\scripts\start-web.ps1 -SkipBuild
```

### 2. start-wx.ps1 - 微信小程序启动脚本
启动微信小程序后端服务

**使用方法：**
```powershell
.\scripts\start-wx.ps1 [参数]
```

**参数说明：**
- `-Profile`: 指定环境配置（默认dev）
- `-BackendPort`: 后端端口（默认8080）
- `-WxApiPort`: 微信API端口（默认8082）
- `-SkipBuild`: 跳过构建
- `-SkipFrontend`: 跳过微信小程序启动提示
- `-SkipBackend`: 跳过后端启动

**示例：**
```powershell
# 默认启动
.\scripts\start-wx.ps1

# 指定端口
.\scripts\start-wx.ps1 -BackendPort 8081
```

### 3. 构建脚本

#### build-all.ps1 - 全量构建
```powershell
.\scripts\build-all.ps1
```

#### build-backend.ps1 - 后端构建
```powershell
.\scripts\build-backend.ps1
```

#### build-vue.ps1 - Vue前端构建
```powershell
.\scripts\build-vue.ps1
```

#### build-wx.ps1 - 微信小程序构建
```powershell
.\scripts\build-wx.ps1
```

## 启动流程

### 首次启动
1. 配置数据库（见README.md）
2. 执行：`.\scripts\start-web.ps1`（会自动启动后端8080和前端9527）
3. 等待构建完成
4. 访问：http://localhost:9527

### 日常开发
```powershell
# 启动管理后台（后端+前端）
.\scripts\start-web.ps1 -SkipBuild

# 仅启动后端服务
.\scripts\start-web.ps1 -SkipFrontend -SkipBuild

# 启动微信小程序后端
.\scripts\start-wx.ps1 -SkipBuild
```

## 常见问题

### 1. 权限问题
```powershell
# 以管理员身份运行PowerShell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

### 2. Maven找不到
```powershell
# 检查Maven路径
mvn -v

# 如果未安装，下载并配置环境变量
# https://maven.apache.org/download.cgi
```

### 3. 端口占用
```powershell
# 检查端口占用
netstat -ano | findstr :8080

# 修改启动端口
.\scripts\start-web.ps1 -Port 8081
```

### 4. 构建失败
```powershell
# 清理后重试
mvn clean
.\scripts\build-all.ps1
```

## 开发模式

### 热重载开发
```powershell
# 后端热部署
mvn spring-boot:run -pl litemall-all

# 前端热重载
cd litemall-vue
npm run dev
```

### 调试模式
```powershell
# 调试启动
java -jar -Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=5005 litemall-all/target/litemall-all-0.1.0-exec.jar
```

## 环境变量配置

### Windows环境变量
```powershell
# Java
JAVA_HOME=C:\Program Files\Java\jdk1.8.0_281
PATH=%JAVA_HOME%\bin

# Maven
MAVEN_HOME=C:\apache-maven-3.8.1
PATH=%MAVEN_HOME%\bin

# Node.js
PATH=C:\Program Files\nodejs
```

### Linux/Mac环境变量
```bash
# ~/.bashrc 或 ~/.zshrc
export JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
export MAVEN_HOME=/opt/apache-maven-3.8.1
export PATH=$JAVA_HOME/bin:$MAVEN_HOME/bin:$PATH
```

## 日志查看

### 后端日志
```powershell
# 查看实时日志
tail -f logs/spring.log

# 查看启动日志
type logs/spring.log
```

### 前端日志
```powershell
# Vue前端日志
cd litemall-vue
npm run dev
```

## 停止服务

### 优雅停止
```powershell
# 使用脚本停止（Ctrl+C）
# 或关闭终端窗口
```

### 强制停止
```powershell
# 查找Java进程
jps -l

# 强制结束进程
taskkill /F /PID 进程号
```