# litemall 应用启动方式指南

## 概述
本文档记录litemall应用的正确启动方式，确保修改后的代码能够正确生效。

## 前提条件
- Java 21+ 已安装
- Maven 已安装
- Docker 已运行（包含MySQL数据库）

## 正确的启动步骤

### 1. 停止当前运行的应用
如果应用正在运行，先停止当前进程：
```powershell
# 查看Java进程
Get-Process java

# 停止指定进程（替换PID）
Stop-Process -Id <PID> -Force
```

### 2. 重新编译项目
**重要：修改代码后必须重新编译！**

```powershell
# 在项目根目录执行
cd litemall
mvn clean package -DskipTests
```

### 3. 启动应用
使用编译后的JAR文件启动：

```powershell
# 进入litemall-all目录
cd litemall-all

# 启动应用
java -jar target/litemall-all-0.1.0-exec.jar
```

## 常见问题和解决方案

### 问题1：代码修改未生效
**原因**：应用通过Spring Boot Maven插件运行，使用的是旧的编译版本

**解决方案**：
1. 停止当前应用
2. 执行 `mvn clean package -DskipTests`
3. 使用新编译的JAR文件启动

### 问题2：Jackson时间序列化格式错误
**现象**：时间字段显示为数组格式 `[2025,12,8,16,16,23]`

**解决方案**：
确保重新编译后启动，Jackson配置会自动生效，时间字段将正确显示为字符串格式：
- `birthday`: `"1993-03-25"`
- `lastLoginTime`: `"2025-12-08 16:16:23"`
- `addTime`: `"2025-12-08 16:16:23"`
- `updateTime`: `"2025-12-08 16:16:23"`

## 验证应用状态

### 检查应用是否启动成功
访问健康检查接口：
```powershell
curl http://localhost:8080/admin/auth/login -X POST -H "Content-Type: application/json" -d '{"username":"admin123","password":"admin123"}'
```

### 验证时间字段格式
获取JWT token后测试用户列表接口：
```powershell
# PowerShell
$body = @{username="admin123"; password="admin123"} | ConvertTo-Json
$login = Invoke-RestMethod -Uri "http://localhost:8080/admin/auth/login" -Method Post -Body $body -ContentType "application/json"
$token = $login.data.token
$headers = @{Authorization="Bearer $token"}
Invoke-RestMethod -Uri "http://localhost:8080/admin/user/list?page=1&limit=1" -Method Get -Headers $headers -ContentType "application/json"
```

## 注意事项

1. **每次修改后端代码后都必须重新编译**
2. **不要使用Maven插件运行应用**，直接使用JAR文件启动
3. **确保使用正确的JAR文件**：`target/litemall-all-0.1.0-exec.jar`
4. **检查端口8080是否被占用**

## 相关文件
- Jackson配置文件：`litemall-core/src/main/java/org/linlinjava/litemall/core/config/JacksonConfig.java`
- 编译输出：`litemall-all/target/litemall-all-0.1.0-exec.jar`
- 日志文件：`litemall-all/logs/log.log`

前端：
cd litemall-admin
npm run dev