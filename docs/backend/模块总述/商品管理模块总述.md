## 商品管理模块总述

### 模块架构设计

#### 分层架构分析
| 架构层次 | 核心组件 | 主要职责 | 技术实现 |
|---------|---------|---------|---------|
| 控制器层 | AdminGoodsController | 接收HTTP请求、参数验证、权限控制 | Spring MVC注解 |
| 服务层 | AdminGoodsService | 业务逻辑处理、事务管理、数据验证 | Spring Service注解 |
| 数据访问层 | GoodsMapper及相关Mapper | 数据库操作、SQL执行 | MyBatis XML配置 |
| 数据传输层 | GoodsAllinone | 数据封装、前后端数据交换 | POJO对象 |

#### 核心类职责分析
| 类名 | 包路径 | 主要职责 | 关键方法 |
|------|-------|---------|---------|
| AdminGoodsController | org.linlinjava.litemall.admin.web | HTTP接口暴露、权限控制 | list(), create(), update(), delete(), detail(), list2() |
| AdminGoodsService | org.linlinjava.litemall.admin.service | 业务逻辑核心处理 | validate(), update(), delete(), create(), list2(), detail() |
| GoodsAllinone | org.linlinjava.litemall.admin.dto | 商品完整数据封装 | getGoods(), setGoods(), getSpecifications(), setSpecifications()等 |

### 业务逻辑深度分析

#### 商品创建流程
```java
// 核心业务逻辑流程
1. 参数验证 → 2. 开启事务 → 3. 保存商品基本信息 → 4. 处理规格信息 → 
5. 处理属性信息 → 6. 处理货品信息 → 7. 提交事务 → 8. 更新缓存
```

#### 数据验证机制
| 验证类型 | 验证方法 | 验证规则 | 错误处理 |
|---------|---------|---------|---------|
| 必填字段验证 | validate()方法 | 检查商品名称、价格等必填字段 | 抛出IllegalArgumentException |
| 数据格式验证 | 服务层验证 | 价格数值范围、库存非负等 | 返回错误码和提示信息 |
| 业务规则验证 | 业务逻辑验证 | 商品编号唯一性、分类存在性等 | 事务回滚并记录日志 |

#### 事务管理策略
| 事务场景 | 传播行为 | 隔离级别 | 超时设置 | 回滚规则 |
|---------|---------|---------|---------|---------|
| 商品创建 | REQUIRED | READ_COMMITTED | 30秒 | RuntimeException回滚 |
| 商品更新 | REQUIRED | READ_COMMITTED | 30秒 | RuntimeException回滚 |
| 商品删除 | REQUIRED | READ_COMMITTED | 10秒 | RuntimeException回滚 |

### 数据库设计分析

#### 表结构关系
| 表名 | 主键 | 外键关系 | 索引设计 | 数据量预估 |
|------|-----|---------|---------|-----------|
| litemall_goods | id | category_id, brand_id | name, category_id | 10万+ |
| litemall_goods_specification | id | goods_id | goods_id, specification | 50万+ |
| litemall_goods_attribute | id | goods_id | goods_id, attribute | 30万+ |
| litemall_goods_product | id | goods_id | goods_id, specifications | 20万+ |

#### 查询性能分析
| 查询类型 | SQL复杂度 | 执行时间 | 优化空间 | 建议措施 |
|---------|----------|---------|---------|---------|
| 商品列表查询 | 中等（多表关联） | <100ms | 中等 | 添加复合索引 |
| 商品详情查询 | 简单（单表查询） | <50ms | 低 | 详情缓存 |
| 条件筛选查询 | 复杂（多条件） | 100-300ms | 高 | 查询优化 |
