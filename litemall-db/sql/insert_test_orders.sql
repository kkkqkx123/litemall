-- 订单统计拓展功能测试数据插入脚本
-- 创建时间：2024年
-- 目的：为订单统计拓展功能提供测试数据，支持时间维度和商品类别筛选

-- 1. 创建测试用户（如果用户数量不足）
INSERT IGNORE INTO litemall_user (username, password, gender, birthday, last_login_time, last_login_ip, user_level, nickname, mobile, avatar, weixin_openid, status, add_time, update_time, deleted) VALUES
('test_user1', '$2a$10$v3J5J8qJ8qJ8qJ8qJ8qJ8u', 0, '1990-01-01', NOW(), '127.0.0.1', 0, '测试用户1', '13800000001', '', '', 0, NOW(), NOW(), 0),
('test_user2', '$2a$10$v3J5J8qJ8qJ8qJ8qJ8qJ8u', 1, '1992-05-15', NOW(), '127.0.0.1', 0, '测试用户2', '13800000002', '', '', 0, NOW(), NOW(), 0),
('test_user3', '$2a$10$v3J5J8qJ8qJ8qJ8qJ8qJ8u', 0, '1988-12-20', NOW(), '127.0.0.1', 0, '测试用户3', '13800000003', '', '', 0, NOW(), NOW(), 0),
('test_user4', '$2a$10$v3J5J8qJ8qJ8qJ8qJ8qJ8u', 1, '1995-07-08', NOW(), '127.0.0.1', 0, '测试用户4', '13800000004', '', '', 0, NOW(), NOW(), 0),
('test_user5', '$2a$10$v3J5J8qJ8qJ8qJ8qJ8qJ8u', 0, '1993-03-25', NOW(), '127.0.0.1', 0, '测试用户5', '13800000005', '', '', 0, NOW(), NOW(), 0);

-- 2. 插入测试订单数据（覆盖不同时间维度和商品类别）
-- 订单状态说明：401-订单完成，402-订单完成（评价完成）
INSERT INTO litemall_order (user_id, order_sn, order_status, consignee, mobile, address, message, goods_price, freight_price, coupon_price, integral_price, groupon_price, order_price, actual_price, pay_id, pay_time, ship_sn, ship_channel, ship_time, confirm_time, comments, end_time, add_time, update_time, deleted) VALUES

-- 2024年1月数据（按日统计测试）
(1, '202401010001', 401, '张三', '13800000001', '北京市朝阳区', '', 100.00, 10.00, 0.00, 0.00, 0.00, 110.00, 110.00, NULL, '2024-01-01 10:00:00', NULL, NULL, NULL, NULL, 0, '2024-01-02 10:00:00', '2024-01-01 09:30:00', NOW(), 0),
(2, '202401010002', 402, '李四', '13800000002', '上海市浦东新区', '', 200.00, 15.00, 10.00, 0.00, 0.00, 205.00, 205.00, NULL, '2024-01-01 11:00:00', NULL, NULL, NULL, NULL, 0, '2024-01-03 11:00:00', '2024-01-01 10:30:00', NOW(), 0),
(3, '202401020001', 401, '王五', '13800000003', '广州市天河区', '', 150.00, 12.00, 5.00, 0.00, 0.00, 157.00, 157.00, NULL, '2024-01-02 14:00:00', NULL, NULL, NULL, NULL, 0, '2024-01-04 14:00:00', '2024-01-02 13:30:00', NOW(), 0),
(4, '202401020002', 401, '赵六', '13800000004', '深圳市南山区', '', 80.00, 8.00, 0.00, 0.00, 0.00, 88.00, 88.00, NULL, '2024-01-02 16:00:00', NULL, NULL, NULL, NULL, 0, '2024-01-05 16:00:00', '2024-01-02 15:30:00', NOW(), 0),

-- 2024年1月第1周数据（按周统计测试）
(5, '202401030001', 402, '钱七', '13800000005', '杭州市西湖区', '', 300.00, 20.00, 15.00, 0.00, 0.00, 305.00, 305.00, NULL, '2024-01-03 09:00:00', NULL, NULL, NULL, NULL, 0, '2024-01-06 09:00:00', '2024-01-03 08:30:00', NOW(), 0),
(1, '202401040001', 401, '张三', '13800000001', '北京市朝阳区', '', 120.00, 10.00, 0.00, 0.00, 0.00, 130.00, 130.00, NULL, '2024-01-04 11:00:00', NULL, NULL, NULL, NULL, 0, '2024-01-07 11:00:00', '2024-01-04 10:30:00', NOW(), 0),
(2, '202401050001', 402, '李四', '13800000002', '上海市浦东新区', '', 250.00, 15.00, 10.00, 0.00, 0.00, 255.00, 255.00, NULL, '2024-01-05 14:00:00', NULL, NULL, NULL, NULL, 0, '2024-01-08 14:00:00', '2024-01-05 13:30:00', NOW(), 0),

-- 2024年1月第2周数据
(3, '202401080001', 401, '王五', '13800000003', '广州市天河区', '', 180.00, 12.00, 5.00, 0.00, 0.00, 187.00, 187.00, NULL, '2024-01-08 10:00:00', NULL, NULL, NULL, NULL, 0, '2024-01-10 10:00:00', '2024-01-08 09:30:00', NOW(), 0),
(4, '202401090001', 401, '赵六', '13800000004', '深圳市南山区', '', 90.00, 8.00, 0.00, 0.00, 0.00, 98.00, 98.00, NULL, '2024-01-09 13:00:00', NULL, NULL, NULL, NULL, 0, '2024-01-11 13:00:00', '2024-01-09 12:30:00', NOW(), 0),
(5, '202401100001', 402, '钱七', '13800000005', '杭州市西湖区', '', 350.00, 25.00, 20.00, 0.00, 0.00, 355.00, 355.00, NULL, '2024-01-10 16:00:00', NULL, NULL, NULL, NULL, 0, '2024-01-12 16:00:00', '2024-01-10 15:30:00', NOW(), 0),

-- 2024年2月数据（按月统计测试）
(1, '202402010001', 401, '张三', '13800000001', '北京市朝阳区', '', 200.00, 15.00, 10.00, 0.00, 0.00, 205.00, 205.00, NULL, '2024-02-01 10:00:00', NULL, NULL, NULL, NULL, 0, '2024-02-03 10:00:00', '2024-02-01 09:30:00', NOW(), 0),
(2, '202402150001', 402, '李四', '13800000002', '上海市浦东新区', '', 400.00, 20.00, 15.00, 0.00, 0.00, 405.00, 405.00, NULL, '2024-02-15 14:00:00', NULL, NULL, NULL, NULL, 0, '2024-02-17 14:00:00', '2024-02-15 13:30:00', NOW(), 0),
(3, '202402280001', 401, '王五', '13800000003', '广州市天河区', '', 150.00, 12.00, 5.00, 0.00, 0.00, 157.00, 157.00, NULL, '2024-02-28 16:00:00', NULL, NULL, NULL, NULL, 0, '2024-03-02 16:00:00', '2024-02-28 15:30:00', NOW(), 0),

-- 2024年3月数据
(4, '202403100001', 401, '赵六', '13800000004', '深圳市南山区', '', 120.00, 10.00, 0.00, 0.00, 0.00, 130.00, 130.00, NULL, '2024-03-10 11:00:00', NULL, NULL, NULL, NULL, 0, '2024-03-12 11:00:00', '2024-03-10 10:30:00', NOW(), 0),
(5, '202403200001', 402, '钱七', '13800000005', '杭州市西湖区', '', 280.00, 18.00, 12.00, 0.00, 0.00, 286.00, 286.00, NULL, '2024-03-20 14:00:00', NULL, NULL, NULL, NULL, 0, '2024-03-22 14:00:00', '2024-03-20 13:30:00', NOW(), 0);

-- 3. 插入订单商品数据（关联不同商品类别）
-- 获取商品ID和类别ID的映射关系
SET @goods_1005000 = (SELECT id FROM litemall_goods WHERE category_id = 1005000 LIMIT 1);
SET @goods_1005001 = (SELECT id FROM litemall_goods WHERE category_id = 1005001 LIMIT 1);
SET @goods_1005002 = (SELECT id FROM litemall_goods WHERE category_id = 1005002 LIMIT 1);
SET @goods_1005007 = (SELECT id FROM litemall_goods WHERE category_id = 1005007 LIMIT 1);
SET @goods_1005008 = (SELECT id FROM litemall_goods WHERE category_id = 1005008 LIMIT 1);

-- 插入订单商品数据
INSERT INTO litemall_order_goods (order_id, goods_id, goods_name, goods_sn, product_id, number, price, specifications, pic_url, add_time, update_time, deleted) VALUES
-- 2024年1月订单商品
(1, COALESCE(@goods_1005000, 1006002), '测试商品1', 'G001', 0, 1, 100.00, '[]', '', NOW(), NOW(), 0),
(2, COALESCE(@goods_1005001, 1006007), '测试商品2', 'G002', 0, 2, 100.00, '[]', '', NOW(), NOW(), 0),
(3, COALESCE(@goods_1005002, 1006010), '测试商品3', 'G003', 0, 1, 150.00, '[]', '', NOW(), NOW(), 0),
(4, COALESCE(@goods_1005007, 1006013), '测试商品4', 'G004', 0, 1, 80.00, '[]', '', NOW(), NOW(), 0),

-- 2024年1月第1周订单商品
(5, COALESCE(@goods_1005008, 1006014), '测试商品5', 'G005', 0, 3, 100.00, '[]', '', NOW(), NOW(), 0),
(6, COALESCE(@goods_1005000, 1006002), '测试商品6', 'G006', 0, 1, 120.00, '[]', '', NOW(), NOW(), 0),
(7, COALESCE(@goods_1005001, 1006007), '测试商品7', 'G007', 0, 2, 125.00, '[]', '', NOW(), NOW(), 0),

-- 2024年1月第2周订单商品
(8, COALESCE(@goods_1005002, 1006010), '测试商品8', 'G008', 0, 1, 180.00, '[]', '', NOW(), NOW(), 0),
(9, COALESCE(@goods_1005007, 1006013), '测试商品9', 'G009', 0, 1, 90.00, '[]', '', NOW(), NOW(), 0),
(10, COALESCE(@goods_1005008, 1006014), '测试商品10', 'G010', 0, 3, 116.67, '[]', '', NOW(), NOW(), 0),

-- 2024年2月订单商品
(11, COALESCE(@goods_1005000, 1006002), '测试商品11', 'G011', 0, 2, 100.00, '[]', '', NOW(), NOW(), 0),
(12, COALESCE(@goods_1005001, 1006007), '测试商品12', 'G012', 0, 4, 100.00, '[]', '', NOW(), NOW(), 0),
(13, COALESCE(@goods_1005002, 1006010), '测试商品13', 'G013', 0, 1, 150.00, '[]', '', NOW(), NOW(), 0),

-- 2024年3月订单商品
(14, COALESCE(@goods_1005007, 1006013), '测试商品14', 'G014', 0, 1, 120.00, '[]', '', NOW(), NOW(), 0),
(15, COALESCE(@goods_1005008, 1006014), '测试商品15', 'G015', 0, 2, 140.00, '[]', '', NOW(), NOW(), 0);

-- 4. 验证数据插入结果
SELECT '订单统计测试数据插入完成' as result;
SELECT COUNT(*) as '订单总数' FROM litemall_order WHERE order_status IN (401,402);
SELECT COUNT(DISTINCT user_id) as '用户数量' FROM litemall_order WHERE order_status IN (401,402);
SELECT MIN(add_time) as '最早订单时间', MAX(add_time) as '最晚订单时间' FROM litemall_order WHERE order_status IN (401,402);